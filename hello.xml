<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE vxml PUBLIC "-//W3C//DTD VOICEXML 2.1//EN" "http://www.w3.org/TR/2007/REC-voicexml21-20070619/vxml.dtd">

<vxml version="2.1" xmlns="http://www.w3.org/2001/vxml" xmlns:voxeo="http://community.voxeo.com/xmlns/vxml" application="root.xml">
    <meta name="maintainer" content="burrelal@gmail.com" />

	<link next="#hello">
		<grammar xml:lang="en-us" type="application/grammar-xml" root="goBack">
			<rule id="goBack" scope="public">
				<one-of>
					<!-- This matches "main" and "main menu" -->
					<item>
						<item> Main </item>
						<item repeat="0-1"> menu </item>
					</item>
					<item> Back </item>
				</one-of>
			</rule>
		</grammar>
	</link>
	
	<!-- The user can end the conversation at any time -->
	<link next="#Exit">
		<grammar xml:lang="en-us" type="application/xml-grammar" root="exit">
			<rule id="exit" scope="public">
				<one-of>
					<item> Exit </item>
					<item>
						<item repeat="0-1"> Good </item>
						<item> bye </item>
					</item>
				</one-of>
			</rule>
		</grammar>
	</link>


    <form id="hello">
        <grammar src="hello_grammar.xml#Greeting" type="application/grammar-xml" maxage="1" />
        <!-- <grammar src="business_grammar.xml#Business" type="application/grammar-xml" maxage="1" /> -->
        <!-- <grammar src="location_grammar.xml#Location" type="application/grammar-xml" maxage="1" /> -->

        <!-- <block>
            <assign name="application.request_type" expr="'address'" />
            <assign name="application.business" expr="'safeway'" />
            <assign name="application.location" expr="'santa cruz'" />
            <goto next="details.xml#GetDetails" />
        </block> -->

        <initial name="Greeting">
            Hi there! What business information can I help you find?

            <nomatch count="1">
                I'm sorry, I'm having trouble understanding.
                <assign name="Greeting" expr="true" />
                <reprompt />
            </nomatch>
        </initial>

        <field name="RequestTypeField">
            <grammar src="hello_grammar.xml#RequestType" type="application/grammar-xml" maxage="1" />
            <prompt>
                Do you want hours, an address, or a phone number?
            </prompt>
        </field>

        <field name="BusinessField">
            <grammar src="business_grammar.xml#Business" type="application/grammar-xml" maxage="1" />
            <prompt>
                What business are you wondering about?
            </prompt>
        </field>

        <field name="LocationField">
            <grammar src="location_grammar.xml#Location" type="application/grammar-xml" maxage="1" />
            <prompt>
                Where are you?
            </prompt>
        </field>

        <filled mode="all">
        
        	<prompt>
        		Providing <value expr="RequestTypeField"/> for <value expr="BusinessField"/>
        		in <value expr="LocationField"/>. <break strength="medium" />
        	</prompt>
        	
            <assign name="application.request_type" expr="RequestTypeField$.interpretation.RequestTypeField" />
            <assign name="application.business" expr="BusinessField$.interpretation.BusinessField" />
            <assign name="application.location" expr="LocationField$.interpretation.LocationField" />
            <goto next="details.xml#GetDetails" />
        </filled>
    </form>
    
    	<!-- Form to end conversation -->
	<form id="Exit">
		<block>
			<prompt> Goodbye! </prompt>
		</block>
		<exit/>
	</form>

</vxml>
